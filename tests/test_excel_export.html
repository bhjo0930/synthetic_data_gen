<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Excel Export ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section { 
            margin: 20px 0; 
            padding: 20px; 
            border: 2px solid #000;
            background: #fff;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: 2px solid #000;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 5px;
            box-shadow: 4px 4px 0px #000;
        }
        .test-button:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0px #000;
        }
        .result { 
            margin: 10px 0; 
            padding: 10px;
            border: 1px solid #ddd;
            background: #f9f9f9;
        }
        .success { 
            color: green; 
            border-color: green;
            background: #e8f5e8;
        }
        .error { 
            color: red; 
            border-color: red;
            background: #ffeaea;
        }
        .data-preview {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #ccc;
            padding: 10px;
            font-size: 12px;
            background: #f8f8f8;
        }
    </style>
    <!-- SheetJS ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="test-container">
        <h1>ğŸ“Š Excel Export ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="test-section">
            <h2>1. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ í™•ì¸</h2>
            <button class="test-button" onclick="checkLibraries()">
                <i class="fas fa-check"></i> ë¼ì´ë¸ŒëŸ¬ë¦¬ í™•ì¸
            </button>
            <div id="libraryResult" class="result"></div>
        </div>
        
        <div class="test-section">
            <h2>2. ìƒ˜í”Œ ë°ì´í„° ìƒì„±</h2>
            <button class="test-button" onclick="generateSampleData()">
                <i class="fas fa-users"></i> ìƒ˜í”Œ ë°ì´í„° ìƒì„±
            </button>
            <div id="dataResult" class="result"></div>
            <div id="dataPreview" class="data-preview" style="display:none;"></div>
        </div>
        
        <div class="test-section">
            <h2>3. íŒŒì¼ ë‚´ë³´ë‚´ê¸° í…ŒìŠ¤íŠ¸</h2>
            <button class="test-button" onclick="testExcelExport()" id="exportTestBtn" disabled>
                <i class="fas fa-file-excel"></i> Excel ë‚´ë³´ë‚´ê¸° í…ŒìŠ¤íŠ¸
            </button>
            <button class="test-button" onclick="testCsvExport()" id="csvTestBtn" disabled style="background: #28a745;">
                <i class="fas fa-file-csv"></i> CSV ë‚´ë³´ë‚´ê¸° í…ŒìŠ¤íŠ¸
            </button>
            <div id="exportResult" class="result"></div>
        </div>
        
        <div class="test-section">
            <h2>4. ë‹¤ì–‘í•œ ë°ì´í„° íƒ€ì… í…ŒìŠ¤íŠ¸</h2>
            <button class="test-button" onclick="testComplexData()">
                <i class="fas fa-database"></i> ë³µí•© ë°ì´í„° í…ŒìŠ¤íŠ¸
            </button>
            <div id="complexResult" class="result"></div>
        </div>
    </div>

    <script>
        let sampleData = [];

        function checkLibraries() {
            const result = document.getElementById('libraryResult');
            let html = '<h3>ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒíƒœ:</h3>';
            
            // XLSX ë¼ì´ë¸ŒëŸ¬ë¦¬ í™•ì¸
            if (typeof XLSX !== 'undefined') {
                html += '<div class="success">âœ… SheetJS (XLSX) ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œë¨</div>';
                html += `<div>ë²„ì „: ${XLSX.version || 'ì•Œ ìˆ˜ ì—†ìŒ'}</div>`;
            } else {
                html += '<div class="error">âŒ SheetJS (XLSX) ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì‹¤íŒ¨</div>';
            }
            
            result.innerHTML = html;
            result.className = typeof XLSX !== 'undefined' ? 'result success' : 'result error';
        }

        function generateSampleData() {
            const result = document.getElementById('dataResult');
            const preview = document.getElementById('dataPreview');
            
            try {
                // ìƒ˜í”Œ í˜ë¥´ì†Œë‚˜ ë°ì´í„° ìƒì„±
                sampleData = [];
                const regions = ['ì„œìš¸íŠ¹ë³„ì‹œ', 'ê²½ê¸°ë„', 'ë¶€ì‚°ê´‘ì—­ì‹œ', 'ëŒ€êµ¬ê´‘ì—­ì‹œ', 'ì¸ì²œê´‘ì—­ì‹œ'];
                const genders = ['ë‚¨ì„±', 'ì—¬ì„±'];
                const occupations = ['ìì˜ì—…', 'íšŒì‚¬ì›', 'í•™ìƒ', 'ì „ë¬¸ì§', 'êµì‚¬'];
                const educations = ['ê³ ë“±í•™êµ', 'ëŒ€í•™(4ë…„ì œ ë¯¸ë§Œ)', 'ëŒ€í•™êµ(4ë…„ì œ ì´ìƒ)', 'ëŒ€í•™ì›(ì„ì‚¬ ê³¼ì •)'];
                const maritalStatuses = ['ë¯¸í˜¼', 'ê¸°í˜¼', 'ì´í˜¼'];
                
                for (let i = 1; i <= 50; i++) {
                    const persona = {
                        name: `ê°€ìƒì¸ë¬¼_${i.toString().padStart(3, '0')}`,
                        age: Math.floor(Math.random() * 50) + 20,
                        gender: genders[Math.floor(Math.random() * genders.length)],
                        location: regions[Math.floor(Math.random() * regions.length)],
                        occupation: occupations[Math.floor(Math.random() * occupations.length)],
                        education: educations[Math.floor(Math.random() * educations.length)],
                        income_bracket: `${Math.floor(Math.random() * 5) * 20 + 20}-${Math.floor(Math.random() * 5) * 20 + 40}%`,
                        marital_status: maritalStatuses[Math.floor(Math.random() * maritalStatuses.length)],
                        interests: ['ë…ì„œ', 'ì˜í™”ê°ìƒ', 'ìš´ë™', 'ì—¬í–‰'].slice(0, Math.floor(Math.random() * 3) + 1),
                        values: ['ê°€ì¡±', 'ì„±ê³µ', 'ê±´ê°•', 'ììœ '].slice(0, Math.floor(Math.random() * 2) + 1),
                        lifestyle: ['í™œë™ì ', 'ì—¬ìœ ë¡œìš´', 'ê³„íšì '].slice(0, Math.floor(Math.random() * 2) + 1),
                        personality: ['ì™¸í–¥ì ', 'ì‹ ì¤‘í•œ', 'ì°½ì˜ì '].slice(0, Math.floor(Math.random() * 2) + 1),
                        media_consumption: 'ì†Œì…œë¯¸ë””ì–´ 3ì‹œê°„/ì¼',
                        shopping_habits: 'ì˜¨ë¼ì¸ ì‡¼í•‘ ì„ í˜¸',
                        social_relations: 'ì¹œêµ¬ ë§ìŒ'
                    };
                    sampleData.push(persona);
                }
                
                result.innerHTML = `
                    <div class="success">âœ… ${sampleData.length}ê°œ ìƒ˜í”Œ ë°ì´í„° ìƒì„± ì™„ë£Œ</div>
                    <div>ì²« ë²ˆì§¸ ë°ì´í„°: ${sampleData[0].name} (${sampleData[0].age}ì„¸, ${sampleData[0].gender})</div>
                `;
                result.className = 'result success';
                
                // ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°
                let previewHtml = '<h4>ë°ì´í„° ë¯¸ë¦¬ë³´ê¸° (ì²˜ìŒ 5ê°œ):</h4>';
                sampleData.slice(0, 5).forEach((persona, index) => {
                    previewHtml += `
                        <div style="margin: 5px 0; padding: 5px; border: 1px solid #ddd;">
                            ${index + 1}. ${persona.name} - ${persona.age}ì„¸ ${persona.gender}, ${persona.location}, ${persona.occupation}
                        </div>
                    `;
                });
                preview.innerHTML = previewHtml;
                preview.style.display = 'block';
                
                // ë‚´ë³´ë‚´ê¸° ë²„íŠ¼ë“¤ í™œì„±í™”
                document.getElementById('exportTestBtn').disabled = false;
                document.getElementById('csvTestBtn').disabled = false;
                
            } catch (error) {
                result.innerHTML = `<div class="error">âŒ ë°ì´í„° ìƒì„± ì‹¤íŒ¨: ${error.message}</div>`;
                result.className = 'result error';
            }
        }

        function testExcelExport() {
            const result = document.getElementById('exportResult');
            
            if (sampleData.length === 0) {
                result.innerHTML = '<div class="error">âŒ ë¨¼ì € ìƒ˜í”Œ ë°ì´í„°ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.</div>';
                result.className = 'result error';
                return;
            }
            
            try {
                console.log('Excel ë‚´ë³´ë‚´ê¸° í…ŒìŠ¤íŠ¸ ì‹œì‘...');
                
                // Excel ë°ì´í„° ì¤€ë¹„ (ì‹¤ì œ search.htmlê³¼ ë™ì¼í•œ ë¡œì§)
                const excelData = sampleData.map((persona, index) => {
                    return {
                        'ìˆœë²ˆ': index + 1,
                        'ì´ë¦„': persona.name || 'ë¯¸ì§€ì •',
                        'ë‚˜ì´': persona.age || 0,
                        'ì„±ë³„': persona.gender || 'ë¯¸ì§€ì •',
                        'ì§€ì—­': persona.location || 'ë¯¸ì§€ì •',
                        'ì§ì—…': persona.occupation || 'ë¯¸ì§€ì •',
                        'êµìœ¡ìˆ˜ì¤€': persona.education || 'ë¯¸ì§€ì •',
                        'ì†Œë“ë¶„ìœ„': persona.income_bracket || 'ë¯¸ì§€ì •',
                        'ê²°í˜¼ìƒíƒœ': persona.marital_status || 'ë¯¸ì§€ì •',
                        'ê´€ì‹¬ì‚¬': Array.isArray(persona.interests) ? persona.interests.join(', ') : (persona.interests || ''),
                        'ê°€ì¹˜ê´€': Array.isArray(persona.values) ? persona.values.join(', ') : (persona.values || ''),
                        'ë¼ì´í”„ìŠ¤íƒ€ì¼': Array.isArray(persona.lifestyle) ? persona.lifestyle.join(', ') : (persona.lifestyle || ''),
                        'ì„±ê²©íŠ¹ì„±': Array.isArray(persona.personality) ? persona.personality.join(', ') : (persona.personality || ''),
                        'ë¯¸ë””ì–´ì†Œë¹„': persona.media_consumption || '',
                        'ì‡¼í•‘ìŠµê´€': persona.shopping_habits || '',
                        'ì‚¬íšŒì ê´€ê³„': persona.social_relations || ''
                    };
                });

                // ì›Œí¬ë¶ ìƒì„±
                const wb = XLSX.utils.book_new();
                
                // ì›Œí¬ì‹œíŠ¸ ìƒì„±
                const ws = XLSX.utils.json_to_sheet(excelData);
                
                // ì»¬ëŸ¼ ë„ˆë¹„ ì„¤ì •
                const colWidths = [
                    { wch: 8 },  // ìˆœë²ˆ
                    { wch: 12 }, // ì´ë¦„
                    { wch: 8 },  // ë‚˜ì´
                    { wch: 8 },  // ì„±ë³„
                    { wch: 15 }, // ì§€ì—­
                    { wch: 15 }, // ì§ì—…
                    { wch: 20 }, // êµìœ¡ìˆ˜ì¤€
                    { wch: 12 }, // ì†Œë“ë¶„ìœ„
                    { wch: 12 }, // ê²°í˜¼ìƒíƒœ
                    { wch: 30 }, // ê´€ì‹¬ì‚¬
                    { wch: 30 }, // ê°€ì¹˜ê´€
                    { wch: 30 }, // ë¼ì´í”„ìŠ¤íƒ€ì¼
                    { wch: 30 }, // ì„±ê²©íŠ¹ì„±
                    { wch: 25 }, // ë¯¸ë””ì–´ì†Œë¹„
                    { wch: 25 }, // ì‡¼í•‘ìŠµê´€
                    { wch: 25 }  // ì‚¬íšŒì ê´€ê³„
                ];
                ws['!cols'] = colWidths;

                // ì›Œí¬ì‹œíŠ¸ë¥¼ ì›Œí¬ë¶ì— ì¶”ê°€
                XLSX.utils.book_append_sheet(wb, ws, 'Test Data');
                
                // íŒŒì¼ëª… ìƒì„±
                const now = new Date();
                const dateStr = now.getFullYear() + 
                              String(now.getMonth() + 1).padStart(2, '0') + 
                              String(now.getDate()).padStart(2, '0') + '_' +
                              String(now.getHours()).padStart(2, '0') + 
                              String(now.getMinutes()).padStart(2, '0');
                const filename = `Excel_Export_Test_${dateStr}.xlsx`;
                
                // Excel íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                XLSX.writeFile(wb, filename);
                
                result.innerHTML = `
                    <div class="success">âœ… Excel íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!</div>
                    <div>íŒŒì¼ëª…: ${filename}</div>
                    <div>ë°ì´í„° ìˆ˜: ${sampleData.length}ê°œ</div>
                    <div>ì»¬ëŸ¼ ìˆ˜: 16ê°œ</div>
                `;
                result.className = 'result success';
                
                console.log('Excel íŒŒì¼ ìƒì„± ì„±ê³µ:', filename);
                
            } catch (error) {
                console.error('Excel ë‚´ë³´ë‚´ê¸° ì˜¤ë¥˜:', error);
                result.innerHTML = `<div class="error">âŒ Excel ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨: ${error.message}</div>`;
                result.className = 'result error';
            }
        }

        function testCsvExport() {
            const result = document.getElementById('exportResult');
            
            if (sampleData.length === 0) {
                result.innerHTML = '<div class="error">âŒ ë¨¼ì € ìƒ˜í”Œ ë°ì´í„°ë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.</div>';
                result.className = 'result error';
                return;
            }
            
            try {
                console.log('CSV ë‚´ë³´ë‚´ê¸° í…ŒìŠ¤íŠ¸ ì‹œì‘...');
                
                // CSV í—¤ë” ì •ì˜ (ì‹¤ì œ search.htmlê³¼ ë™ì¼í•œ ë¡œì§)
                const headers = [
                    'ìˆœë²ˆ', 'ì´ë¦„', 'ë‚˜ì´', 'ì„±ë³„', 'ì§€ì—­', 'ì§ì—…', 'êµìœ¡ìˆ˜ì¤€', 'ì†Œë“ë¶„ìœ„', 'ê²°í˜¼ìƒíƒœ',
                    'ê´€ì‹¬ì‚¬', 'ê°€ì¹˜ê´€', 'ë¼ì´í”„ìŠ¤íƒ€ì¼', 'ì„±ê²©íŠ¹ì„±', 'ë¯¸ë””ì–´ì†Œë¹„', 'ì‡¼í•‘ìŠµê´€', 'ì‚¬íšŒì ê´€ê³„'
                ];

                // CSV ë°ì´í„° ìƒì„±
                const csvRows = [];
                
                // í—¤ë” ì¶”ê°€
                csvRows.push(headers.join(','));
                
                // ë°ì´í„° í–‰ ì¶”ê°€
                sampleData.forEach((persona, index) => {
                    const row = [
                        index + 1,
                        `"${(persona.name || 'ë¯¸ì§€ì •').replace(/"/g, '""')}"`, // ìŒë”°ì˜´í‘œ ì´ìŠ¤ì¼€ì´í”„
                        persona.age || 0,
                        `"${(persona.gender || 'ë¯¸ì§€ì •').replace(/"/g, '""')}"`,
                        `"${(persona.location || 'ë¯¸ì§€ì •').replace(/"/g, '""')}"`,
                        `"${(persona.occupation || 'ë¯¸ì§€ì •').replace(/"/g, '""')}"`,
                        `"${(persona.education || 'ë¯¸ì§€ì •').replace(/"/g, '""')}"`,
                        `"${(persona.income_bracket || 'ë¯¸ì§€ì •').replace(/"/g, '""')}"`,
                        `"${(persona.marital_status || 'ë¯¸ì§€ì •').replace(/"/g, '""')}"`,
                        `"${(Array.isArray(persona.interests) ? persona.interests.join(', ') : (persona.interests || '')).replace(/"/g, '""')}"`,
                        `"${(Array.isArray(persona.values) ? persona.values.join(', ') : (persona.values || '')).replace(/"/g, '""')}"`,
                        `"${(Array.isArray(persona.lifestyle) ? persona.lifestyle.join(', ') : (persona.lifestyle || '')).replace(/"/g, '""')}"`,
                        `"${(Array.isArray(persona.personality) ? persona.personality.join(', ') : (persona.personality || '')).replace(/"/g, '""')}"`,
                        `"${(persona.media_consumption || '').replace(/"/g, '""')}"`,
                        `"${(persona.shopping_habits || '').replace(/"/g, '""')}"`,
                        `"${(persona.social_relations || '').replace(/"/g, '""')}"`
                    ];
                    csvRows.push(row.join(','));
                });

                // CSV ë¬¸ìì—´ ìƒì„±
                const csvContent = csvRows.join('\n');
                
                // BOM ì¶”ê°€ (í•œê¸€ ê¹¨ì§ ë°©ì§€)
                const BOM = '\uFEFF';
                const csvWithBOM = BOM + csvContent;

                // Blob ìƒì„±
                const blob = new Blob([csvWithBOM], { type: 'text/csv;charset=utf-8;' });
                
                // íŒŒì¼ëª… ìƒì„±
                const now = new Date();
                const dateStr = now.getFullYear() + 
                              String(now.getMonth() + 1).padStart(2, '0') + 
                              String(now.getDate()).padStart(2, '0') + '_' +
                              String(now.getHours()).padStart(2, '0') + 
                              String(now.getMinutes()).padStart(2, '0');
                const filename = `CSV_Export_Test_${dateStr}.csv`;
                
                // ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„± ë° í´ë¦­
                const link = document.createElement('a');
                if (link.download !== undefined) {
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', filename);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                }
                
                result.innerHTML = `
                    <div class="success">âœ… CSV íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!</div>
                    <div>íŒŒì¼ëª…: ${filename}</div>
                    <div>ë°ì´í„° ìˆ˜: ${sampleData.length}ê°œ</div>
                    <div>ì»¬ëŸ¼ ìˆ˜: 16ê°œ</div>
                    <div>ì¸ì½”ë”©: UTF-8 with BOM (í•œê¸€ ì§€ì›)</div>
                `;
                result.className = 'result success';
                
                console.log('CSV íŒŒì¼ ìƒì„± ì„±ê³µ:', filename);
                
            } catch (error) {
                console.error('CSV ë‚´ë³´ë‚´ê¸° ì˜¤ë¥˜:', error);
                result.innerHTML = `<div class="error">âŒ CSV ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨: ${error.message}</div>`;
                result.className = 'result error';
            }
        }

        function testComplexData() {
            const result = document.getElementById('complexResult');
            
            try {
                // ë³µì¡í•œ ë°ì´í„° íƒ€ì… í…ŒìŠ¤íŠ¸ (Excel & CSV ëª¨ë‘)
                const complexData = [
                    {
                        'ìˆœë²ˆ': 1,
                        'ë¬¸ìì—´': 'í•œê¸€ í…ìŠ¤íŠ¸',
                        'ìˆ«ì': 12345,
                        'ë‚ ì§œ': new Date().toLocaleDateString(),
                        'ë°°ì—´': ['í•­ëª©1', 'í•­ëª©2', 'í•­ëª©3'].join(', '),
                        'ë¶ˆë¦°': 'true',
                        'íŠ¹ìˆ˜ë¬¸ì': '!@#$%^&*()_+',
                        'ê¸´í…ìŠ¤íŠ¸': 'ì´ê²ƒì€ ë§¤ìš° ê¸´ í…ìŠ¤íŠ¸ì…ë‹ˆë‹¤. '.repeat(5),
                        'ë¹ˆê°’': '',
                        'ìŒë”°ì˜´í‘œ': 'He said "Hello"',
                        'ì½¤ë§ˆí¬í•¨': 'A, B, C'
                    }
                ];

                // Excel í…ŒìŠ¤íŠ¸
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.json_to_sheet(complexData);
                XLSX.utils.book_append_sheet(wb, ws, 'Complex Data Test');
                const excelFilename = `Complex_Excel_Test_${Date.now()}.xlsx`;
                XLSX.writeFile(wb, excelFilename);
                
                // CSV í…ŒìŠ¤íŠ¸
                const headers = Object.keys(complexData[0]);
                const csvRows = [headers.join(',')];
                complexData.forEach(row => {
                    const values = headers.map(header => {
                        const value = String(row[header] || '');
                        return `"${value.replace(/"/g, '""')}"`;
                    });
                    csvRows.push(values.join(','));
                });
                
                const csvContent = '\uFEFF' + csvRows.join('\n'); // BOM ì¶”ê°€
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const csvFilename = `Complex_CSV_Test_${Date.now()}.csv`;
                
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', csvFilename);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                result.innerHTML = `
                    <div class="success">âœ… ë³µí•© ë°ì´í„° íƒ€ì… í…ŒìŠ¤íŠ¸ ì™„ë£Œ!</div>
                    <div>Excel íŒŒì¼: ${excelFilename}</div>
                    <div>CSV íŒŒì¼: ${csvFilename}</div>
                    <div>ë‹¤ì–‘í•œ ë°ì´í„° íƒ€ì… ì²˜ë¦¬ í™•ì¸ (íŠ¹ìˆ˜ë¬¸ì, ìŒë”°ì˜´í‘œ, ì½¤ë§ˆ ë“±)</div>
                `;
                result.className = 'result success';
                
            } catch (error) {
                result.innerHTML = `<div class="error">âŒ ë³µí•© ë°ì´í„° í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${error.message}</div>`;
                result.className = 'result error';
            }
        }

        // í˜ì´ì§€ ë¡œë“œì‹œ ìë™ ë¼ì´ë¸ŒëŸ¬ë¦¬ í™•ì¸
        window.addEventListener('load', () => {
            setTimeout(checkLibraries, 500);
        });
    </script>
</body>
</html>